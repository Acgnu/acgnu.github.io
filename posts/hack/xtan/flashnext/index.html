<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="背景 本文再续 某琴吧EXE播放器破解记录, 意在解决Adobe停止维护Flash后, 整个Flash失效导致播放器无法使用的问题.
2020年末Adobe公司停止了对Flash的维护, 随之而来的是浏览器删除了对Flash的支持, 包括Windows系统内安装的Flash也无法继续使用, 而我们获取乐谱资源需要用到Flash版的某琴吧播放器, 之前使用的是AxShockwaveFlash, 这个组件也是引用了Windows上安装的Flash, 只能寻找其他替代方案
 此文章编辑于2024年8月, 实际改造在2021年5月就已完成, 因此没有早期Flash失效截图. 另外某琴吧在2023年再次更新, 用手机版APP取代了PC版播放器, 所以此破解方案在此时已失效, 再此仅为记录
 目标 使Flash版某琴吧播放器可用
分析 首先简单回顾一下破解过程, 我们先反编译了Flash版的某琴吧播放器, 然后在源码中增加了一个swfExtGetypURL方法, 此方法根据传入的乐谱ID返回乐谱资源URL, 再通过ExternalInterface.addCallback将该方法暴露给Flash容器, 我们就可以使用容器与Flash通信了. 而现在的问题是, 容器即AxShockwaveFlash组件由于Flash停止维护已经用不了了, 那么有没有什么办法能够继续运行Flash呢? 答案是有的, 我们还有另一种独立的Flash Player应用程序, 它不需要安装, 下载到电脑后双击即可运行
 Adobe Flash Player 29截图 
如上图所示, 启动之后界面是空白的, 因为没有运行Flash文件, 我们可以单击 文件 - 打开, 来选择一个.swf后缀的Flash文件进行播放, 例如下图是来自QQ秀的.swf文件运行效果
 image-3 
 实际上当时下载到的最新版本为Adobe Flash Player 3x, 这些版本也受到了停止维护的影响无法使用, 直到我逐个尝试旧版之后才找到了可用的版本 29
 如何传入参数?
根据 某琴吧Flash播放器破解记录 中的描述, 打开某琴吧播放器是需要传入一个id参数的, 那么这个图形化界面我们应该如何传入参数呢?"><title>关于Adobe Flash失效后如何继续使用某弹播放器</title><link rel=canonical href=/posts/hack/xtan/flashnext/><link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="关于Adobe Flash失效后如何继续使用某弹播放器"><meta property="og:description" content="背景 本文再续 某琴吧EXE播放器破解记录, 意在解决Adobe停止维护Flash后, 整个Flash失效导致播放器无法使用的问题.
2020年末Adobe公司停止了对Flash的维护, 随之而来的是浏览器删除了对Flash的支持, 包括Windows系统内安装的Flash也无法继续使用, 而我们获取乐谱资源需要用到Flash版的某琴吧播放器, 之前使用的是AxShockwaveFlash, 这个组件也是引用了Windows上安装的Flash, 只能寻找其他替代方案
 此文章编辑于2024年8月, 实际改造在2021年5月就已完成, 因此没有早期Flash失效截图. 另外某琴吧在2023年再次更新, 用手机版APP取代了PC版播放器, 所以此破解方案在此时已失效, 再此仅为记录
 目标 使Flash版某琴吧播放器可用
分析 首先简单回顾一下破解过程, 我们先反编译了Flash版的某琴吧播放器, 然后在源码中增加了一个swfExtGetypURL方法, 此方法根据传入的乐谱ID返回乐谱资源URL, 再通过ExternalInterface.addCallback将该方法暴露给Flash容器, 我们就可以使用容器与Flash通信了. 而现在的问题是, 容器即AxShockwaveFlash组件由于Flash停止维护已经用不了了, 那么有没有什么办法能够继续运行Flash呢? 答案是有的, 我们还有另一种独立的Flash Player应用程序, 它不需要安装, 下载到电脑后双击即可运行
 Adobe Flash Player 29截图 
如上图所示, 启动之后界面是空白的, 因为没有运行Flash文件, 我们可以单击 文件 - 打开, 来选择一个.swf后缀的Flash文件进行播放, 例如下图是来自QQ秀的.swf文件运行效果
 image-3 
 实际上当时下载到的最新版本为Adobe Flash Player 3x, 这些版本也受到了停止维护的影响无法使用, 直到我逐个尝试旧版之后才找到了可用的版本 29
 如何传入参数?
根据 某琴吧Flash播放器破解记录 中的描述, 打开某琴吧播放器是需要传入一个id参数的, 那么这个图形化界面我们应该如何传入参数呢?"><meta property="og:url" content="/posts/hack/xtan/flashnext/"><meta property="og:site_name" content="Acgnu+"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:tag" content="Hack"><meta property="article:tag" content="Flash"><meta property="article:tag" content="Flex"><meta property="article:tag" content="ActionScript"><meta property="article:tag" content=".NET"><meta property="article:published_time" content="2024-08-22T00:50:44+08:00"><meta property="article:modified_time" content="2024-08-22T00:50:44+08:00"><meta property="og:image" content="/posts/hack/xtan/flashnext/cover.png"><meta name=twitter:title content="关于Adobe Flash失效后如何继续使用某弹播放器"><meta name=twitter:description content="背景 本文再续 某琴吧EXE播放器破解记录, 意在解决Adobe停止维护Flash后, 整个Flash失效导致播放器无法使用的问题.
2020年末Adobe公司停止了对Flash的维护, 随之而来的是浏览器删除了对Flash的支持, 包括Windows系统内安装的Flash也无法继续使用, 而我们获取乐谱资源需要用到Flash版的某琴吧播放器, 之前使用的是AxShockwaveFlash, 这个组件也是引用了Windows上安装的Flash, 只能寻找其他替代方案
 此文章编辑于2024年8月, 实际改造在2021年5月就已完成, 因此没有早期Flash失效截图. 另外某琴吧在2023年再次更新, 用手机版APP取代了PC版播放器, 所以此破解方案在此时已失效, 再此仅为记录
 目标 使Flash版某琴吧播放器可用
分析 首先简单回顾一下破解过程, 我们先反编译了Flash版的某琴吧播放器, 然后在源码中增加了一个swfExtGetypURL方法, 此方法根据传入的乐谱ID返回乐谱资源URL, 再通过ExternalInterface.addCallback将该方法暴露给Flash容器, 我们就可以使用容器与Flash通信了. 而现在的问题是, 容器即AxShockwaveFlash组件由于Flash停止维护已经用不了了, 那么有没有什么办法能够继续运行Flash呢? 答案是有的, 我们还有另一种独立的Flash Player应用程序, 它不需要安装, 下载到电脑后双击即可运行
 Adobe Flash Player 29截图 
如上图所示, 启动之后界面是空白的, 因为没有运行Flash文件, 我们可以单击 文件 - 打开, 来选择一个.swf后缀的Flash文件进行播放, 例如下图是来自QQ秀的.swf文件运行效果
 image-3 
 实际上当时下载到的最新版本为Adobe Flash Player 3x, 这些版本也受到了停止维护的影响无法使用, 直到我逐个尝试旧版之后才找到了可用的版本 29
 如何传入参数?
根据 某琴吧Flash播放器破解记录 中的描述, 打开某琴吧播放器是需要传入一个id参数的, 那么这个图形化界面我们应该如何传入参数呢?"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/posts/hack/xtan/flashnext/cover.png"><link rel="shortcut icon" href=/favicon.ico></head><body class="article-page keep-sidebar"><script>(function(){const colorSchemeKey='StackColorScheme';if(!localStorage.getItem(colorSchemeKey)){localStorage.setItem(colorSchemeKey,"auto");}})();</script><script>(function(){const colorSchemeKey='StackColorScheme';const colorSchemeItem=localStorage.getItem(colorSchemeKey);const supportDarkMode=window.matchMedia('(prefers-color-scheme: dark)').matches===true;if(colorSchemeItem=='dark'||colorSchemeItem==='auto'&&supportDarkMode){document.body.dataset.scheme='dark';}else{document.body.dataset.scheme='light';}})();</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header class=site-info><figure class=site-avatar><img src=/img/avatar_hu3a9833e4ebdcf9e444b7caf140fa72b8_113624_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
<span class=emoji>😎</span></figure><h1 class=site-name><a href=/>Acgnu+</a></h1><h2 class=site-description>時間はいつも足りない</h2></header><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/about><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/hack/xtan/flashnext/><img src=/posts/hack/xtan/flashnext/cover_hu70fa8e1fca53387730a1b13673b63af7_3461492_800x0_resize_box_2.png srcset="/posts/hack/xtan/flashnext/cover_hu70fa8e1fca53387730a1b13673b63af7_3461492_800x0_resize_box_2.png 800w, /posts/hack/xtan/flashnext/cover_hu70fa8e1fca53387730a1b13673b63af7_3461492_1600x0_resize_box_2.png 1600w" width=800 height=476 loading=lazy alt="Featured image of post 关于Adobe Flash失效后如何继续使用某弹播放器"></a></div><div class=article-details><header class=article-category><a href=/categories/hack/>Hack</a></header><h2 class=article-title><a href=/posts/hack/xtan/flashnext/>关于Adobe Flash失效后如何继续使用某弹播放器</a></h2><footer class=article-time><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--published>Aug 22, 2024</time></footer></div></header><section class=article-content><h2 id=背景>背景</h2><p>本文再续 <a class=link href=../exe>某琴吧EXE播放器破解记录</a>, 意在解决Adobe停止维护Flash后, 整个Flash失效导致播放器无法使用的问题.</p><p>2020年末Adobe公司停止了对Flash的维护, 随之而来的是浏览器删除了对Flash的支持, 包括Windows系统内安装的Flash也无法继续使用, 而我们获取乐谱资源需要用到Flash版的某琴吧播放器, 之前使用的是<code>AxShockwaveFlash</code>, 这个组件也是引用了Windows上安装的Flash, 只能寻找其他替代方案</p><blockquote><p>此文章编辑于2024年8月, 实际改造在2021年5月就已完成, 因此没有早期Flash失效截图. 另外某琴吧在2023年再次更新, 用手机版APP取代了PC版播放器, 所以此破解方案在此时已失效, 再此仅为记录</p></blockquote><h2 id=目标>目标</h2><p>使Flash版某琴吧播放器可用</p><h2 id=分析>分析</h2><p>首先简单回顾一下破解过程, 我们先反编译了Flash版的某琴吧播放器, 然后在源码中增加了一个<code>swfExtGetypURL</code>方法, 此方法根据传入的乐谱ID返回乐谱资源URL, 再通过<code>ExternalInterface.addCallback</code>将该方法暴露给Flash容器, 我们就可以使用容器与Flash通信了. 而现在的问题是, 容器即<code>AxShockwaveFlash</code>组件由于Flash停止维护已经用不了了, 那么有没有什么办法能够继续运行Flash呢? 答案是有的, 我们还有另一种独立的Flash Player应用程序, 它不需要安装, 下载到电脑后双击即可运行</p><p><figure style=flex-grow:190;flex-basis:456px><a href=/posts/hack/xtan/flashnext/1.png data-size=417x219><img src=/posts/hack/xtan/flashnext/1.png srcset="/posts/hack/xtan/flashnext/1_hu58fa83f76cdc50691390964a6dfa1201_5146_480x0_resize_box_2.png 480w, /posts/hack/xtan/flashnext/1_hu58fa83f76cdc50691390964a6dfa1201_5146_1024x0_resize_box_2.png 1024w" width=417 height=219 loading=lazy alt="Adobe Flash Player 29截图"></a><figcaption>Adobe Flash Player 29截图</figcaption></figure></p><p>如上图所示, 启动之后界面是空白的, 因为没有运行Flash文件, 我们可以单击 文件 - 打开, 来选择一个<code>.swf</code>后缀的Flash文件进行播放, 例如下图是来自QQ秀的<code>.swf</code>文件运行效果</p><p><figure style=flex-grow:109;flex-basis:263px><a href=/posts/hack/xtan/flashnext/3.png data-size=331x301><img src=/posts/hack/xtan/flashnext/3.png srcset="/posts/hack/xtan/flashnext/3_hu7b5c7312fc7bea6799449d4b07168a61_38842_480x0_resize_box_2.png 480w, /posts/hack/xtan/flashnext/3_hu7b5c7312fc7bea6799449d4b07168a61_38842_1024x0_resize_box_2.png 1024w" width=331 height=301 loading=lazy alt=image-3></a><figcaption>image-3</figcaption></figure></p><blockquote><p>实际上当时下载到的最新版本为Adobe Flash Player 3x, 这些版本也受到了停止维护的影响无法使用, 直到我逐个尝试旧版之后才找到了可用的版本 29</p></blockquote><p><strong>如何传入参数?</strong></p><p>根据 <a class=link href=../flash>某琴吧Flash播放器破解记录</a> 中的描述, 打开某琴吧播放器是需要传入一个<code>id</code>参数的, 那么这个图形化界面我们应该如何传入参数呢? 实际上我们可以手动在打开的文件后面键入<code>?id=xx</code>, 就可以把<code>id</code>参数传给某琴吧播放器了</p><p><figure style=flex-grow:153;flex-basis:369px><a href=/posts/hack/xtan/flashnext/2.png data-size=463x301><img src=/posts/hack/xtan/flashnext/2.png srcset="/posts/hack/xtan/flashnext/2_hu7ef1f64de5ce6734e26839ac9cb5a89d_10041_480x0_resize_box_2.png 480w, /posts/hack/xtan/flashnext/2_hu7ef1f64de5ce6734e26839ac9cb5a89d_10041_1024x0_resize_box_2.png 1024w" width=463 height=301 loading=lazy alt=image-2></a><figcaption>image-2</figcaption></figure></p><p><strong>如何使用命令行启动?</strong></p><p>我们希望实际执行的时候由程序进行控制, 而不是每次都需要人为在界面上操作, 我们知道Windows可以通过命令行的方式启动<code>.exe</code>文件, 并附加执行参数传递给被执行的文件, 但前提是被执行文件支持命令行传参才行, 那么Flash Player是否支持呢? 答案是支持的, 我们可以通过以下方式来启动并播放一个Flash文件</p><pre><code>flashplayer.exe file.swf?id=666
</code></pre><blockquote><p>其实Flash Player是否支持传参, 以及具体传入格式并没有查到相关文档, 此处仅凭借经验以及猜测得知</p></blockquote><p><strong>如何实现某琴吧播放器与Flash Player通信?</strong></p><p>很遗憾, 我们并不知道如何让Flash Player和某琴吧播放器通信, 因此我们不能采用之前外部接口的方式去获取乐谱资源, 但是我们可以依然可以改造一下某琴吧播放器, <strong>此前是容器向某琴吧播放器发起调用获取到乐谱资源URL</strong>, 现在可以<strong>改造为某琴吧播放器启动后将乐谱资源URL参数通过HTTP主动请求到我们搭建的Web服务上</strong>, 再由Web服务器解析后去下载乐谱资源</p><h2 id=实践>实践</h2><p><strong>修改某琴吧播放器源码</strong></p><p>根据 <a class=link href=../flash>某琴吧Flash播放器破解记录</a> 我们知道要得到乐谱资源URL, 就需要调用<code>CLib.getURL</code>并传入乐谱ID, 在之前修改的基础上, 我们再次修改一下 <code>onSoundsReady</code> 方法, 如下所示</p><pre><code>internal static function onSoundsReady(arg1:Event) : void
{
    swfLoader.contentLoaderInfo.removeEventListener(Event.COMPLETE,onSoundsReady);
    var loc1:* = swfLoader.contentLoaderInfo.applicationDomain;
    var loc2:* = loc1.getDefinition(&quot;Sounds&quot;) as Class;
    CLib.clib = loc2.cLibInit();
    if(utils.Func.ypadId != 0) {
        //由于 Flash Player 不可交互, 修改为启动时将琴谱地址上传, 宿主判断是否下载
        var url:* = CLib.getURL(utils.Func.ypadId);
        //url:* 结果为 http://www.和谐.com/flash_get_yp_info.php?ypid=66138&amp;amp;sccode=77c83a7bf44542486ff37815ab75c147&amp;amp;r1=9185&amp;amp;r2=6640&amp;amp;input=123
        var args:* = &quot;?&quot; + url.split(&quot;?&quot;)[1]
        urlLoader3 = new flash.net.URLLoader();
        urlLoader3.load(new flash.net.URLRequest(Config.flash_yuepu_fetch_URL + args));
    }
}
</code></pre><p>代码相较于之前的版本, 仅仅只是在初始化<code>CLib</code>之后, 增加了一个发起HTTP请求的代码, 具体解释如下</p><ol><li><code>utils.Func.ypadId</code>是某琴吧播放器启动后, 会把传入到播放器的<code>id</code>参数, 赋值于此</li><li><code>CLib</code>初始化完成之后, 调用一次<code>CLib.getURL</code>, 得到该乐谱的资源URL</li><li>通过字符串的<code>split</code>方法, 把原始资源文件地址中的域名和参数分割</li><li>丢弃原始资源的域名部分, 将参数部分拼接到<code>Config.flash_yuepu_fetch_URL</code>后, 这是一个本地搭建的Web服务地址, 具体为 <a class=link href>http://localhost:7777/yuepu/fetch</a>, 而后<code>urlLoader3.load</code>将会发起HTTP请求</li></ol><p>此时完整的流程为, 某琴吧播放器启动后, 初始化的方法<code>init1</code>中会调用<code>CLib.myLoadSwf</code>, 从而加载音色库, 当音色库加载完成之后, 就会调用回调函数<code>onSoundsReady</code>, 执行到上面的代码</p><p><strong>添加信任文件</strong></p><p>默认情况下, Flash Player 8 以后的版本<font color=red>禁止本地<code>.swf</code>发送Internet请求</font>, 可参阅 <a class=link href=https://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html#117502 target=_blank rel=noopener>关于Flash Player的安全说明</a>, 因此我们还需要为某琴吧播放器添加信任文件来解除限制</p><p>在Windows中的<code>%APPDATA%\Macromedia\Flash Player\#Security\FlashPlayerTrust</code>目录下创建一个<code>.cfg</code>文件, 文件名称随意, 例如<code>acgnux_flash.cfg</code>, 并添加需要被执行的<code>.swf</code>目录作为内容</p><p><figure style=flex-grow:349;flex-basis:837px><a href=/posts/hack/xtan/flashnext/4.png data-size=747x214><img src=/posts/hack/xtan/flashnext/4.png srcset="/posts/hack/xtan/flashnext/4_hua97852b9f50607a2a5532baa20701adb_16075_480x0_resize_box_2.png 480w, /posts/hack/xtan/flashnext/4_hua97852b9f50607a2a5532baa20701adb_16075_1024x0_resize_box_2.png 1024w" width=747 height=214 loading=lazy alt=image-4></a><figcaption>image-4</figcaption></figure></p><p>当然, 我们也可以使用代码来自动化这个流程</p><pre><code>public static void WriteTrustFile()
{
    var appDataPath = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);
    FileUtil.SaveStringToFile(Environment.CurrentDirectory + @&quot;\Assets\flash&quot;, appDataPath + @&quot;\Macromedia\Flash Player\#Security\FlashPlayerTrust\&quot;, &quot;acgnux_flash.cfg&quot;);
}
</code></pre><blockquote><p>填写为目录表示该目录下所有<code>.swf</code>文件都受到信任, 也可以只填写单个<code>.swf</code>文件路径, 表示只信任这一个</p></blockquote><p><strong>Web服务器中代码</strong></p><p>在本地搭建<code>7777</code>端口的Web服务, 并监听地址<code>/yuepu/fetch</code>请求, <code>C#</code>示例代码如下:</p><pre><code>private void FetchPianoScore(HttpListenerContext httpListenerContext)
{
    //传入参数样本 ?ypid=29189&amp;sccode=0373ef7aa7c3e092b8c4e09748574186&amp;r1=8538&amp;r2=5971&amp;input=123
    Ypid = Convert.ToInt32(httpListenerContext.Request.QueryString[&quot;ypid&quot;]),
    SheetUrl = string.Format(&quot;http://www.和谐.com/flash_get_yp_info.php?ypid={0}&amp;sccode={1}&amp;r1={2}&amp;r2={3}&amp;input=123&quot;,
    httpListenerContext.Request.QueryString[&quot;ypid&quot;],
    httpListenerContext.Request.QueryString[&quot;sccode&quot;],
    httpListenerContext.Request.QueryString[&quot;r1&quot;],
    httpListenerContext.Request.QueryString[&quot;r2&quot;])
}
</code></pre><p>我们将得到的四个核心参数, 与真正的资源服务器地址结合, 再次组合成完整的URL后就可以获取乐谱资源了</p><h2 id=后续步骤>后续步骤</h2><p>后续就比较简单了, 主要就是自动抓取乐谱, 在<code>C#</code>主要可以拆分为以下几个步骤</p><ol><li>自增得到一个乐谱ID, 通过<code>Process.Start</code>启动Flash Player</li></ol><pre><code>    Process.Start(new ProcessStartInfo()
    {
        FileName = &quot;flashplayer.exe&quot;,
        Arguments = &quot;Main.swf?id=666&quot;
    });
</code></pre><ol start=2><li>某琴吧播放器在Flash Player中运行之后, 会主动发起一个HTTP请求到<a class=link href>http://localhost:7777/yuepu/fetch</a> 并附带关键参数</li><li>Web服务接收到请求之后, 可以根据传入的乐谱ID参数, 来判断这个乐谱文件是否已经下载过, 如果已经下载过, 则不做任何操作, 如果没有下载过, 则开始执行下载操作</li></ol></section><footer class=article-footer><section class=article-tags><a href=/tags/hack/>Hack</a>
<a href=/tags/flash/>Flash</a>
<a href=/tags/flex/>Flex</a>
<a href=/tags/actionscript/>ActionScript</a>
<a href=/tags/.net/>.NET</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2021 -
2024 Acgnu+</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=2.3.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const customFont=document.createElement('link');customFont.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";customFont.type="text/css";customFont.rel="stylesheet";document.head.appendChild(customFont);}());</script></body></html>